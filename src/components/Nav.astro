---
import { navigation } from '../data/navigation';
import { Icon } from 'astro-icon/components';

const currentPath = Astro.url.pathname;
---

<header class="fixed top-0 left-0 right-0 z-40 bg-white/80 dark:bg-gray-950/80 backdrop-blur-md border-b border-gray-200/60 dark:border-gray-800/60">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <nav class="flex items-center justify-between h-16">
      <!-- Logo / Brand -->
      <a href="/" class="text-lg font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
        Tristan Germer
      </a>

      <!-- Desktop Navigation -->
      <ul class="hidden md:flex items-center gap-1">
        {navigation.map((item) => {
          const isActive = currentPath.startsWith(item.link);
          return (
            <li>
              <a
                href={item.link}
                class={`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${
                  isActive
                    ? 'bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300'
                    : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-900 hover:text-gray-900 dark:hover:text-white'
                }`}
                aria-current={isActive ? 'page' : undefined}
              >
                {item.name}
              </a>
            </li>
          );
        })}
      </ul>

      <!-- Mobile hamburger -->
      <button
        id="mobile-menu-btn"
        class="md:hidden p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-900"
        aria-label="Menü öffnen"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <Icon name="tabler:menu-2" id="hamburger-icon" class="h-5 w-5" />
        <Icon name="tabler:x" id="close-icon" class="h-5 w-5 hidden" />
      </button>
    </nav>

    <!-- Mobile menu -->
    <div
      id="mobile-menu"
      class="hidden md:hidden pb-4"
    >
      <ul class="flex flex-col gap-1">
        {navigation.map((item) => {
          const isActive = currentPath.startsWith(item.link);
          return (
            <li>
              <a
                href={item.link}
                class={`block px-3 py-2 rounded-lg text-sm font-medium transition-colors ${
                  isActive
                    ? 'bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300'
                    : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-900'
                }`}
                aria-current={isActive ? 'page' : undefined}
              >
                {item.name}
              </a>
            </li>
          );
        })}
      </ul>
    </div>
  </div>
</header>

<script>
  const btn = document.getElementById('mobile-menu-btn');
  const menu = document.getElementById('mobile-menu');
  const hamburger = document.getElementById('hamburger-icon');
  const closeIcon = document.getElementById('close-icon');

  btn?.addEventListener('click', () => {
    const isOpen = !menu?.classList.contains('hidden');
    menu?.classList.toggle('hidden');
    hamburger?.classList.toggle('hidden', isOpen);
    closeIcon?.classList.toggle('hidden', !isOpen);
    btn.setAttribute('aria-expanded', String(!isOpen));
  });
</script>
